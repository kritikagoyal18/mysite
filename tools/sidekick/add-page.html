<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Google Drive Folder Viewer</title>
</head>
<body>
  <h1>Google Drive Folder Structure</h1>
  <ul id="folder-structure"></ul>

  <script>
    const folderUrl = 'https://drive.google.com/drive/folders/1I5OPtzRgSRdRE9qEG2sXeownbAkwUJbO';

    function getFolderId(url) {
      const match = url.match(/\/folders\/([a-zA-Z0-9-_]+)/);
      return match ? match[1] : null;
    }

    async function fetchFolderContents(folderId) {
      try {
        const response = await fetch(
          `https://www.googleapis.com/drive/v3/files?q='${folderId}'+in+parents+and+trashed=false&fields=files(id,name,mimeType)`,
          { credentials: 'include' }
        );

        if (!response.ok) {
          throw new Error(`Failed to fetch folder contents: ${response.statusText}`);
        }

        const data = await response.json();
        const files = data.files;

        const folderStructure = document.getElementById("folder-structure");
        folderStructure.innerHTML = "";

        if (files && files.length > 0) {
          files.forEach((file) => {
            const li = document.createElement("li");
            li.textContent = `${file.name} (${file.mimeType === "application/vnd.google-apps.folder" ? "Folder" : "File"})`;
            folderStructure.appendChild(li);
          });
        } else {
          folderStructure.innerHTML = "<li>No files found in this folder.</li>";
        }
      } catch (error) {
        console.error("Error fetching folder contents:", error);
      }
    }

    const folderId = getFolderId(folderUrl);
    if (folderId) {
      fetchFolderContents(folderId);
    } else {
      console.error("Invalid folder URL.");
    }
  </script>
</body>
</html>
